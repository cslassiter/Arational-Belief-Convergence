<pre><font color="#007f69">globals</font><font color="#000000"> [ believer-list]<br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [friends belief discriminating-value pop-my-friends ]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#5a5a5a">;; here are the globals that users input in the GUI:</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;1. max-discrim-value (input)</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;2. max-pop-my-friends (input)</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;3. density (slider)</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;4. num-dog (input)</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;5. new-generations? (switch)</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;6. replacement-rate (slider)</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;7. fixed-population? (switch)</font><font color="#000000"><br />  <br />  </font><font color="#0000aa">ca</font><font color="#000000"><br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> fixed-population? </font><font color="#5a5a5a">;; if fixed-population? = TRUE, 100 turtles hatched. Otherwise it's a uniform probability based on the density value.</font><font color="#000000"><br />    [</font><font color="#0000aa">crt</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> [set-up-routine]]<br />    [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> density  [</font><font color="#0000aa">sprout</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] ] </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [set-up-routine]]<br />  <br />  </font><font color="#0000aa">if</font><font color="#000000"> num-dog </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [assign-dogmatists] </font><font color="#5a5a5a">;; assign dogmatists, if applicable</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> believer-list [] </font><font color="#5a5a5a">;; believer-list is needed for looking at how beliefs are more or less popular over time. Esp useful for fixed pop with dogmatists.</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> n </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> believer-list </font><font color="#660096">lput</font><font color="#000000"> n believer-list<br />      </font><font color="#0000aa">set</font><font color="#000000"> n n </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]<br />  <br /></font><font color="#0000aa">if</font><font color="#000000"> max-discrim-value </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;can't have a max-discriminating-value equal to or greater than 1.0&quot;</font><font color="#000000">] </font><font color="#5a5a5a">;; juuuuust making sure these values stay below 1.0</font><font color="#000000"><br /></font><font color="#0000aa">if</font><font color="#000000"> max-pop-my-friends </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;can't have a max-pop-my-friends equal to or greater than 1.0&quot;</font><font color="#000000">]<br />  </font><font color="#0000aa">if</font><font color="#000000"> num-dog </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> fixed-population? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">FALSE</font><font color="#000000"> [</font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;you sure you want to have (num-dog &gt; 0) and (fixed-population? = FALSE) ? Model runs fine but you'll have to interpret reporter outputs accordingly.&quot;</font><font color="#000000">]<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> set-up-routine<br />  </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles-here</font><font color="#000000"> [set-up-routine]<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">.75</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">wrap-color</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> belief </font><font color="#660096">who</font><font color="#000000"><br />    </font><font color="#5a5a5a">;;; if you want turtles to be the same, move &quot;random-float&quot; after the semicolon</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> discriminating-value </font><font color="#660096">random-float</font><font color="#000000"> max-discrim-value </font><font color="#5a5a5a">;</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-my-friends </font><font color="#660096">random-float</font><font color="#000000"> max-pop-my-friends   </font><font color="#5a5a5a">;</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> assign-dogmatists<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> num-dog </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> discriminating-value </font><font color="#963700">0</font><font color="#000000">]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go  <br />  find-friends<br />  influence<br />  update-color<br />  plot-belief<br />  plot-pop-by-belief<br />  </font><font color="#0000aa">if</font><font color="#000000"> pop-with-shared-belief </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [ end-routine </font><font color="#0000aa">stop</font><font color="#000000">] </font><font color="#5a5a5a">;; this is for converging on a single belief or just letting the model run with num-dog &gt; 1</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (num-dog </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (beliefs-in-circulation </font><font color="#660096">=</font><font color="#000000"> num-dog) [ end-routine </font><font color="#0000aa">stop</font><font color="#000000">] </font><font color="#5a5a5a">;; this is for converging on as many beliefs as there are dogmatists</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> new-generations? [ </font><font color="#5a5a5a">;; this is if you want to have turtles die and get replaced</font><font color="#000000"><br />    die-and-replace]<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;; a smattering of useful reporters</font><font color="#000000"><br /></font><font color="#5a5a5a">;; reporters are designed to work without replacing turtles, i.e. with &quot;new-generations?&quot; switched off.</font><font color="#000000"><br /></font><font color="#5a5a5a">;; in the case that a consensus is reached with &quot;new-generations?&quot; switched on and the winning turtle has died, many of the following reporters will throw errors.</font><font color="#000000"><br /></font><font color="#5a5a5a">;; 'winning turtle' refers to the turtle whose belief is adopted by everyone</font><font color="#000000"><br /></font><font color="#5a5a5a">;; these all served a purpose at one time or another when exploring the model.</font><font color="#000000"><br /></font><font color="#5a5a5a">;; i'm keeping them in because (a) i don't remember which plots and reporters depend on what and (b) it doesn't do any harm and leave them in and</font><font color="#000000"><br /></font><font color="#5a5a5a">;; (c) they still output handy information</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> count-believers </font><font color="#5a5a5a">;; reports list of the proportion of the population endorsing each belief</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> n []<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> believer-list [ i -&gt; </font><font color="#0000aa">set</font><font color="#000000"> n </font><font color="#660096">lput</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [belief </font><font color="#660096">=</font><font color="#000000"> i]) n]<br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">map</font><font color="#000000"> [j -&gt; j </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">length</font><font color="#000000"> n] n)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> winner-in-list-audience </font><font color="#5a5a5a">;; makes a list ordered by pop-my-friends, and reports the position of the winning turtle in that list</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> ((</font><font color="#660096">position</font><font color="#000000"> [pop-my-friends] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> final-belief (</font><font color="#660096">sort</font><font color="#000000"> [pop-my-friends] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">)) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> winner-in-list-PBC </font><font color="#5a5a5a">;; like the previous reporter but for PBC (output is a list)</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> ((</font><font color="#660096">position</font><font color="#000000"> [discriminating-value] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> final-belief (</font><font color="#660096">sort</font><font color="#000000"> [discriminating-value] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">)) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> winner-PBC </font><font color="#5a5a5a">;; reports the PBC of the winning turtle (output is a float)</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> [discriminating-value] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> final-belief<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> winner-audience </font><font color="#5a5a5a">;; reports pop-my-friends for winning turtle (output is a float)</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> [pop-my-friends] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> final-belief<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> max-discrim-diff </font><font color="#5a5a5a">;; reports the difference between highest and lowest PBC (output is a float)</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> l [discriminating-value] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">max</font><font color="#000000"> l) </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#660096">min</font><font color="#000000"> l)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> min-discrim-value </font><font color="#5a5a5a">;; reports the lowest PBC (output is a float)</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">min</font><font color="#000000"> [discriminating-value] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> discrim-diff </font><font color="#5a5a5a">;; reports the difference between the winning PBC and lowest PBC (output is a float)</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> [discriminating-value] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> final-belief </font><font color="#660096">-</font><font color="#000000"> min-discrim-value<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> low-discrim-agent </font><font color="#5a5a5a">;; reports the identity of agent with lowest PBC (output is an integer)</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [discriminating-value </font><font color="#660096">=</font><font color="#000000"> min-discrim-value]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> list-of-beliefs </font><font color="#5a5a5a">;; reports a list of beliefs that are still endorsed by agents</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">remove-duplicates</font><font color="#000000"> [belief] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> final-belief </font><font color="#5a5a5a">;; reports the belief that's converged upon (output is an integer)</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> list-of-beliefs<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> pop-with-shared-belief </font><font color="#5a5a5a">;; reports how many turtles endorse the most widely-endorsed belief (output is an integer)</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> b-list []<br />  </font><font color="#0000aa">set</font><font color="#000000"> b-list [belief] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> m []<br />  </font><font color="#0000aa">set</font><font color="#000000"> m </font><font color="#660096">modes</font><font color="#000000"> b-list<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">length</font><font color="#000000"> m </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> m (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#660096">min</font><font color="#000000"> m)] </font><font color="#5a5a5a">;; if there is more than one mode, pick the smallest value</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> t </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> b-list [ ?1 -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> ?1 m [</font><font color="#0000aa">set</font><font color="#000000"> t t </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] ]<br />  </font><font color="#0000aa">report</font><font color="#000000"> t<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> beliefs-in-circulation </font><font color="#5a5a5a">;; reports number of beliefs still in circulation (output is an integer)</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> m </font><font color="#660096">remove-duplicates</font><font color="#000000"> [belief] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">length</font><font color="#000000"> m<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> agent-belief-pair </font><font color="#5a5a5a">;; reports turtle identity and the belief it endorses</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">map</font><font color="#000000"> [i -&gt; (</font><font color="#660096">sentence</font><font color="#000000"> i [belief] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> i])] believer-list<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;;; main mechanisms for the model</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> find-friends<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> friends </font><font color="#660096">n-of</font><font color="#000000"> </font><font color="#660096">round</font><font color="#000000"> (pop-my-friends </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">) </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> influence </font><font color="#5a5a5a">;; mechanism of belief change. turtle asks friends to adopt belief. friends roll dice to see if that happens</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> friends </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">[<br />    </font><font color="#0000aa">ask</font><font color="#000000"> friends  [<br />      </font><font color="#0000aa">let</font><font color="#000000"> rf </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> rf </font><font color="#660096">&lt;</font><font color="#000000"> discriminating-value [ </font><font color="#0000aa">set</font><font color="#000000"> belief [belief] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">]<br />    ]<br />  ]<br />]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> update-color </font><font color="#5a5a5a">;; this makes convergence more visible with the turtles</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> belief]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> die-and-replace<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> replacement-rate)[<br />      </font><font color="#0000aa">hatch</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />       set-up-routine]<br />      </font><font color="#0000aa">die</font><font color="#000000">]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;;; now to do some plotting</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> plot-belief<br /></font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;hist-plot&quot;</font><font color="#000000"><br /></font><font color="#0000aa">histogram</font><font color="#000000"> [belief] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> plot-pop-by-belief<br /></font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;pop-by-belief&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">set-plot-pen-mode</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />  </font><font color="#0000aa">plotxy</font><font color="#000000">  (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (beliefs-in-circulation </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">)) (pop-with-shared-belief </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">) </font><font color="#5a5a5a">;beliefs-in-circulation</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> end-routine<br />  </font><font color="#0000aa">type</font><font color="#000000"> </font><font color="#963700">&quot;difference between winning turtle discriminating value and lowest discriminating value &quot;</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> discrim-diff<br />    </font><font color="#0000aa">type</font><font color="#000000"> </font><font color="#963700">&quot;difference between highest and lowest discriminating value &quot;</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> max-discrim-diff<br />    </font><font color="#0000aa">type</font><font color="#000000"> </font><font color="#963700">&quot;ratio of winner to max &quot;</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> (discrim-diff </font><font color="#660096">/</font><font color="#000000"> max-discrim-diff)<br />    </font><font color="#0000aa">type</font><font color="#000000"> </font><font color="#963700">&quot;winner is # &quot;</font><font color="#000000"> </font><font color="#0000aa">write</font><font color="#000000"> winner-in-list-PBC </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot; in list of discriminating values&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">type</font><font color="#000000"> </font><font color="#963700">&quot;also winner is # &quot;</font><font color="#000000"> </font><font color="#0000aa">write</font><font color="#000000"> winner-in-list-audience </font><font color="#0000aa">type</font><font color="#000000"> </font><font color="#963700">&quot; in list of audience size&quot;</font><font color="#000000"><br /></font><font color="#007f69">end</font>
</pre>
